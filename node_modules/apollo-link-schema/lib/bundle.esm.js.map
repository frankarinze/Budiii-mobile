{"version":3,"file":"bundle.esm.js","sources":["../src/index.ts"],"sourcesContent":["import { ApolloLink, Operation, FetchResult, Observable } from 'apollo-link';\nimport { execute } from 'graphql/execution/execute';\nimport { GraphQLSchema } from 'graphql/type/schema';\n\nexport namespace SchemaLink {\n  export type ResolverContextFunction = (\n    operation: Operation,\n  ) => Record<string, any>;\n\n  export interface Options {\n    /**\n     * The schema to generate responses from.\n     */\n    schema: GraphQLSchema;\n\n    /**\n     * The root value to use when generating responses.\n     */\n    rootValue?: any;\n\n    /**\n     * A context to provide to resolvers declared within the schema.\n     */\n    context?: ResolverContextFunction | Record<string, any>;\n  }\n}\n\nexport class SchemaLink extends ApolloLink {\n  public schema: GraphQLSchema;\n  public rootValue: any;\n  public context: SchemaLink.ResolverContextFunction | any;\n\n  constructor({ schema, rootValue, context }: SchemaLink.Options) {\n    super();\n\n    this.schema = schema;\n    this.rootValue = rootValue;\n    this.context = context;\n  }\n\n  public request(operation: Operation): Observable<FetchResult> | null {\n    return new Observable<FetchResult>(observer => {\n      Promise.resolve(\n        execute(\n          this.schema,\n          operation.query,\n          this.rootValue,\n          typeof this.context === 'function'\n            ? this.context(operation)\n            : this.context,\n          operation.variables,\n          operation.operationName,\n        ),\n      )\n        .then(data => {\n          if (!observer.closed) {\n            observer.next(data);\n            observer.complete();\n          }\n        })\n        .catch(error => {\n          if (!observer.closed) {\n            observer.error(error);\n          }\n        });\n    });\n  }\n}\n\nexport default SchemaLink;\n"],"names":["tslib_1.__extends"],"mappings":";;;;;IA2BgCA,8BAAU;IAKxC,oBAAY,EAAkD;YAAhD,kBAAM,EAAE,wBAAS,EAAE,oBAAO;QAAxC,YACE,iBAAO,SAKR;QAHC,KAAI,CAAC,MAAM,GAAG,MAAM,CAAC;QACrB,KAAI,CAAC,SAAS,GAAG,SAAS,CAAC;QAC3B,KAAI,CAAC,OAAO,GAAG,OAAO,CAAC;;KACxB;IAEM,4BAAO,GAAd,UAAe,SAAoB;QAAnC,iBA0BC;QAzBC,OAAO,IAAI,UAAU,CAAc,UAAA,QAAQ;YACzC,OAAO,CAAC,OAAO,CACb,OAAO,CACL,KAAI,CAAC,MAAM,EACX,SAAS,CAAC,KAAK,EACf,KAAI,CAAC,SAAS,EACd,OAAO,KAAI,CAAC,OAAO,KAAK,UAAU;kBAC9B,KAAI,CAAC,OAAO,CAAC,SAAS,CAAC;kBACvB,KAAI,CAAC,OAAO,EAChB,SAAS,CAAC,SAAS,EACnB,SAAS,CAAC,aAAa,CACxB,CACF;iBACE,IAAI,CAAC,UAAA,IAAI;gBACR,IAAI,CAAC,QAAQ,CAAC,MAAM,EAAE;oBACpB,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;oBACpB,QAAQ,CAAC,QAAQ,EAAE,CAAC;iBACrB;aACF,CAAC;iBACD,KAAK,CAAC,UAAA,KAAK;gBACV,IAAI,CAAC,QAAQ,CAAC,MAAM,EAAE;oBACpB,QAAQ,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC;iBACvB;aACF,CAAC,CAAC;SACN,CAAC,CAAC;KACJ;IACH,iBAAC;CAxCD,CAAgC,UAAU;;;;;"}